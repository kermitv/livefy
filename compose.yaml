services:
  livify:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: livify-app
    ports:
      - "8080:80"
    restart: unless-stopped

  livify-dev:
    image: node:20-alpine
    container_name: livify-dev
    working_dir: /app
    command: >-
      sh -c 'if [ ! -x node_modules/.bin/concurrently ] || [ ! -f node_modules/.package-lock.json ] || ! cmp -s package-lock.json node_modules/.package-lock.json; then npm install && cp package-lock.json node_modules/.package-lock.json; fi; npm run dev'
    ports:
      - "8080:8080"
    volumes:
      - .:/app
      - livify_node_modules:/app/node_modules
    restart: unless-stopped

volumes:
  livify_node_modules:
